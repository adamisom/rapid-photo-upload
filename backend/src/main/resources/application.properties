spring.application.name=rapidphoto-api

# Database
# For Railway: Set these individual variables in Railway dashboard from DATABASE_URL
# For local: Use docker-compose or local postgres
# Note: Environment variables must be exported (not just set) for Spring Boot to read them
spring.datasource.url=jdbc:postgresql://${PGHOST:localhost}:${PGPORT:5432}/${PGDATABASE:rapidphoto_dev}
spring.datasource.username=${PGUSER:postgres}
spring.datasource.password=${PGPASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# Fallback: If env vars aren't working, uncomment these and comment out the above:
# spring.datasource.url=jdbc:postgresql://localhost:5432/rapidphoto_dev
# spring.datasource.username=postgres
# spring.datasource.password=postgres

# Connection Pool
# Set to 80 to leave room under PostgreSQL max_connections (100)
# Each URL request needs a DB connection, so we limit to 1 batch of 100 URLs at a time
spring.datasource.hikari.maximum-pool-size=80
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA/Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# JWT Configuration (SECRET REQUIRED FROM ENV VAR)
jwt.secret=${JWT_SECRET}
jwt.expiration=86400000

# AWS S3 Configuration (Optional for Phase 2+)
aws.region=${AWS_REGION:us-east-2}
aws.s3.bucket=${AWS_S3_BUCKET:rapidphotoupload-adamisom}
aws.accessKeyId=${AWS_ACCESS_KEY_ID:}
aws.secretAccessKey=${AWS_SECRET_ACCESS_KEY:}
s3.presigned-url-expiration-minutes=30

# Multipart File Upload
spring.servlet.multipart.max-file-size=1100MB
spring.servlet.multipart.max-request-size=1100MB

# Server
server.port=8080
server.servlet.context-path=/

# Logging
# Console: Only show WARN and above (errors, warnings)
logging.level.root=WARN
logging.level.com.rapid=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.boot.autoconfigure=ERROR
logging.level.org.hibernate=WARN
logging.level.com.zaxxer.hikari=WARN

# File logging: Full details go to file
logging.file.name=logs/rapidphoto-api.log
logging.file.max-size=10MB
logging.file.max-history=5
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.console=%d{HH:mm:ss} %-5level %logger{36} - %msg%n
